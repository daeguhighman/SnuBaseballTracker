name: Notify API changes to Slack

on:
  push:
    branches:
      - develop
    paths:
      - "docs/api/SnuBaseballTournamentApi.yml"

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Generate compare URL
        id: vars
        run: |
          COMPARE_URL="https://github.com/${{ github.repository }}/compare/${{ github.event.before }}...${{ github.sha }}"
          echo "compare_url=${COMPARE_URL}" >> $GITHUB_OUTPUT

      - name: Send Slack notification
        uses: slackapi/slack-github-action@v1.24.0
        with:
          payload: |
            {
              "text": ":mega: *API ëª…ì„¸ ë³€ê²½ë¨!*\n`SnuBaseballTournamentApi.yml` íŒŒì¼ì´ `develop` ë¸Œëœì¹˜ì—ì„œ ìˆ˜ì •ë˜ì—ˆì–´ìš”.\n\nğŸ”— <${{ steps.vars.outputs.compare_url }}|ë³€ê²½ ë‚´ìš© í™•ì¸í•˜ê¸°>"
            }
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
